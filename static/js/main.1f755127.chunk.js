(this.webpackJsonptimetabler=this.webpackJsonptimetabler||[]).push([[0],{117:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(46);"development"===n.n(c).a.env.NODE_ENV&&r.a.lazy((function(){return n.e(2).then(n.t.bind(null,315,7))}))(r.a,{trackAllPureComponents:!0});var l=n(161),u=n(12),i=n.n(u),o=(n(96),n(10)),s=n(13),f=n(155),m=n(166),d=n(158),b=n(159),p=n(160),v=n(81),j=n(11),h=n(162),O=n(36),y=n.n(O),E=n(47),g=n(23),x=n(37),k=n(18),S=function(e){var t,n=[],a=Object(k.a)(e);try{for(a.s();!(t=a.n()).done;){var r,c=t.value.classes,l=Object(k.a)(c);try{for(l.s();!(r=l.n()).done;){var u,i=r.value.sessions,o=Object(k.a)(i);try{for(o.s();!(u=o.n()).done;){var s=u.value.teacher;n.includes(s)||n.push(s)}}catch(f){o.e(f)}finally{o.f()}}}catch(f){l.e(f)}finally{l.f()}}}catch(f){a.e(f)}finally{a.f()}return n},w=Object(a.createContext)(void 0);function N(e){var t=e.children,n=Object(a.useState)([]),c=Object(s.a)(n,2),l=c[0],u=c[1],i=Object(a.useState)(Object(g.a)(Array(13)).map((function(){return Array(6).fill(0)}))),o=Object(s.a)(i,2),f=o[0],m=o[1],d=Object(a.useState)([]),b=Object(s.a)(d,2),p=b[0],v=b[1],j=Object(a.useState)([]),h=Object(s.a)(j,2),O=h[0],k=h[1],N=Object(a.useState)(13),P=Object(s.a)(N,2),T=P[0],M=P[1],A=Object(a.useState)(0),C=Object(s.a)(A,2),I=C[0],z=C[1],B=Object(a.useState)(0),J=Object(s.a)(B,2),W=J[0],D=J[1],F=Object(a.useState)([]),q=Object(s.a)(F,2),R=q[0],G=q[1],U=Object(x.b)(S),V=Object(s.a)(U,1)[0];return Object(a.useEffect)((function(){function e(){return(e=Object(E.a)(y.a.mark((function e(){var t;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,V(l);case 2:t=e.sent,v(t),k([]);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[V,l]),r.a.createElement(w.Provider,{value:{subjects:l,week:f,allTeachers:p,maxPeriods:T,minPeriods:I,maxBreaks:W,selectedTeachers:O,timetables:R,setSubjects:u,setMaxPeriods:M,setMinPeriods:z,setMaxBreaks:D,setSelectedTeachers:k,setWeek:m,setTimetables:G}},t)}var P=function(){return Object(a.useContext)(w)},T=function(){var e=P(),t=e.maxBreaks,n=e.setMaxBreaks;return r.a.createElement(h.a,{fullWidth:!0,inputProps:{min:0,max:11},label:"Max breaks",type:"number",value:t,variant:"outlined",onChange:function(e){n(+e.target.value)}})},M={min:0,max:13},A=function(){var e=P(),t=e.minPeriods,n=e.maxPeriods,a=e.setMaxPeriods;var c=n<t?"Max periods must be bigger than or equal to Min periods":"";return r.a.createElement(h.a,{fullWidth:!0,error:n<t,helperText:c,inputProps:M,label:"Max periods per day",type:"number",value:n,variant:"outlined",onChange:function(e){a(+e.target.value)}})},C={min:0,max:13};function I(){var e=P(),t=e.maxPeriods,n=e.minPeriods,a=e.setMinPeriods;var c=t<n?"Min periods must be smaller than or equal to Max periods":"";return r.a.createElement(h.a,{fullWidth:!0,error:t<n,helperText:c,inputProps:C,label:"Min periods per day",type:"number",value:n,variant:"outlined",onChange:function(e){a(+e.target.value)}})}function z(e){return"number"===typeof e}function B(e){return"string"===typeof e}function J(e){var t=e,n=t.day,a=t.start,r=t.length,c=t.room,l=t.teacher;return z(n)&&z(a)&&z(r)&&B(c)&&B(l)}function W(e){var t=e,n=t.group,a=t.max,r=t.empty,c=t.sessions;return B(n)&&z(a)&&z(r)&&function(e){if(!Array.isArray(e))return!1;var t,n=Object(k.a)(e);try{for(n.s();!(t=n.n()).done;){if(!J(t.value))return!1}}catch(a){n.e(a)}finally{n.f()}return!0}(c)}function D(e){var t=e,n=t.subjectId,a=t.subjectName,r=t.credits,c=t.classes;return B(n)&&B(a)&&z(r)&&function(e){if(!Array.isArray(e))return!1;var t,n=Object(k.a)(e);try{for(n.s();!(t=n.n()).done;){if(!W(t.value))return!1}}catch(a){n.e(a)}finally{n.f()}return!0}(c)}var F=function(){var e=P().setSubjects;return r.a.createElement(f.a,{component:"label",variant:"outlined"},"Input subjects",r.a.createElement("input",{hidden:!0,accept:".json",type:"file",value:void 0,onChange:function(t){if(t.target.files){var n=t.target.files[0];if(n.type.endsWith("json")){var a=new FileReader;a.onload=function(t){var n;if(null===(n=t.target)||void 0===n?void 0:n.result){var a=JSON.parse(t.target.result);!function(e){if(!Array.isArray(e))return!1;var t,n=Object(k.a)(e);try{for(n.s();!(t=n.n()).done;){if(!D(t.value))return!1}}catch(a){n.e(a)}finally{n.f()}return!0}(a)?console.log("Invalid file data."):e(a)}},a.readAsText(n),t.target.value=""}}}}))},q=n(165),R=n(72),G=n.n(R),U=n(71),V=n.n(U),_=n(163);function H(){var e=Object(o.a)(["\n  margin-right: 8px;\n"]);return H=function(){return e},e}var K=function(e){return r.a.createElement(h.a,Object.assign({},e,{label:"Teachers to avoid",variant:"outlined"}))},L=r.a.createElement(V.a,{fontSize:"small"}),Q=r.a.createElement(G.a,{fontSize:"small"}),X=Object(j.a)(q.a)(H()),Y=function(e,t){return r.a.createElement(r.a.Fragment,null,r.a.createElement(X,{checked:t.selected,checkedIcon:Q,icon:L}),e)},Z=function(){var e=P(),t=e.allTeachers,n=e.selectedTeachers,a=e.setSelectedTeachers;return r.a.createElement(_.a,{disableCloseOnSelect:!0,fullWidth:!0,multiple:!0,id:"teachers-select",noOptionsText:"Subjects input required",options:t,renderInput:K,renderOption:Y,value:n,onChange:function(e,t){a(t)}})},$=n(77),ee=n.n($);function te(){var e=Object(o.a)(["\n  height: ","px !important;\n"]);return te=function(){return e},e}function ne(){var e=Object(o.a)(["\n  width: ","px;\n  height: ","px;\n  display: flex;\n  border: solid black;\n  border-width: 0 1px 1px 0;\n  align-items: center;\n  justify-content: center;\n  user-select: none;\n  text-align: center;\n"]);return ne=function(){return e},e}function ae(){var e=Object(o.a)(["\n  display: flex;\n"]);return ae=function(){return e},e}function re(){var e=Object(o.a)(["\n  display: flex;\n  flex-direction: column;\n  border: solid black;\n  border-width: 1px 0 0 1px;\n  width: fit-content;\n"]);return re=function(){return e},e}var ce=j.a.div(re()),le=j.a.div(ae()),ue=j.a.div(ne(),48,48),ie=Object(j.a)(ee.a)(te(),336),oe=function(){var e=Object(a.useState)(!1),t=Object(s.a)(e,2),n=t[0],c=t[1],l=Object(a.useState)(1),u=Object(s.a)(l,2),i=u[0],o=u[1],f=P(),m=f.week,d=f.setWeek;function b(e,t,n){var a=JSON.parse(JSON.stringify(m));a[e][t]=n,d(a)}return Object(a.useEffect)((function(){return document.body.onmousedown=function(){return c(!0)},document.body.onmouseup=function(){return c(!1)},function(){document.body.onmousedown=null,document.body.onmouseup=null}}),[]),r.a.createElement(ce,null,r.a.createElement(le,null,r.a.createElement(ue,null),Object(g.a)(Array(6)).map((function(e,t){return r.a.createElement(ue,{key:t},"Th\u1ee9 ",r.a.createElement("br",null)," ",t+2)}))),r.a.createElement(ie,null,Object(g.a)(Array(13)).map((function(e,t){return r.a.createElement(le,{key:t},r.a.createElement(ue,null,"Ti\u1ebft ",r.a.createElement("br",null)," ",t+1),Object(g.a)(Array(6)).map((function(e,a){return r.a.createElement(ue,{key:a,onMouseDown:function(){return function(e,t){var n=1-m[e][t];o(n),b(e,t,n)}(t,a)},onMouseOver:function(){return e=t,r=a,void(n&&b(e,r,i));var e,r}},!!m[t][a]&&"\u274c")})))}))))};function se(){var e=Object(o.a)(["\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n  width: ","px;\n"]);return se=function(){return e},e}function fe(){var e=Object(o.a)(["\n  display: grid;\n  grid-template-columns: 1fr;\n  row-gap: ","px;\n"]);return fe=function(){return e},e}var me=Object(v.a)(),de=j.a.div(fe(),me.spacing(3)),be=j.a.div(se(),337),pe=function(){return r.a.createElement(de,null,r.a.createElement(be,null,r.a.createElement(F,null)),r.a.createElement(be,null,r.a.createElement(Z,null)),r.a.createElement(be,null,"Periods to avoid",r.a.createElement(oe,null)),r.a.createElement(be,null,r.a.createElement(A,null)),r.a.createElement(be,null,r.a.createElement(I,null)),r.a.createElement(be,null,r.a.createElement(T,null)))},ve=n(157),je=n(82),he=function(e){var t=e.subjects,n=e.selectedTeachers,a=e.week,r=e.maxBreaks,c=e.maxPeriods,l=e.minPeriods,u=[],i=JSON.parse(JSON.stringify(a)),o=[];function s(e){var t,a=e.sessions,r=Object(k.a)(a);try{for(r.s();!(t=r.n()).done;){var c=t.value,l=c.day,u=c.start,o=c.length,s=c.teacher;if(n.includes(s))return!1;for(var f=u;f<u+o;f++)if(0!==i[f-1][l-2])return!1}}catch(m){r.e(m)}finally{r.f()}return!0}function f(e,t){var n,a=e.sessions,r=Object(k.a)(a);try{for(r.s();!(n=r.n()).done;)for(var c=n.value,l=c.day,u=c.start,o=c.length,s=u;s<u+o;s++)i[s-1][l-2]=t}catch(f){r.e(f)}finally{r.f()}}function m(e,t){var n=t.subjectId,a=t.subjectName;o.push(Object(je.a)({subjectId:n,subjectName:a},e)),f(e,2)}return function e(n){if(n!==t.length){var a,d=Object(k.a)(t[n].classes);try{for(d.s();!(a=d.n()).done;){var b=a.value;s(b)&&(m(b,t[n]),e(n+1),f(o.pop(),0))}}catch(p){d.e(p)}finally{d.f()}}else(function(){for(var e=0;e<6;e++){for(var t=0,n=0,a=-1,u=0;u<13;u++)2===i[u][e]&&(++t>1&&(n=Math.max(u-a-1,n)),a=u);if(n>r||t>0&&(t<l||t>c))return!1}return!0})()&&u.push(JSON.parse(JSON.stringify(o)))}(0),u};function Oe(){var e=Object(o.a)(["\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  margin-top: -","px;\n  margin-left: -","px;\n"]);return Oe=function(){return e},e}function ye(){var e=Object(o.a)(["\n  position: relative;\n"]);return ye=function(){return e},e}var Ee=j.a.div(ye()),ge=Object(j.a)(ve.a).attrs((function(e){return{halfsize:e.size/2}}))(Oe(),(function(e){return e.halfsize}),(function(e){return e.halfsize})),xe=function(e){var t=e.closeDialog,n=P(),a=n.subjects,c=n.selectedTeachers,l=n.week,u=n.maxBreaks,i=n.maxPeriods,o=n.minPeriods,m=n.setTimetables,d=Object(x.b)(he),b=Object(s.a)(d,2),p=b[0],v=b[1].status;function j(){return(j=Object(E.a)(y.a.mark((function e(){var n;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p({subjects:a,selectedTeachers:c,week:l,maxBreaks:u,maxPeriods:i,minPeriods:o});case 2:n=e.sent,console.log("Timetables:",n),m(n),t();case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return r.a.createElement(Ee,null,r.a.createElement(f.a,{color:"primary",disabled:v===x.a.RUNNING,onClick:function(){return j.apply(this,arguments)}},"Build timetables"),v===x.a.RUNNING&&r.a.createElement(ge,{size:24}))},ke=n(156),Se=n(118),we=n(78),Ne=n.n(we);function Pe(){var e=Object(o.a)(["\n  position: absolute;\n  right: ","px;\n  top: ","px;\n  color: ",";\n"]);return Pe=function(){return e},e}var Te=Object(v.a)(),Me=Object(j.a)(ke.a)(Pe(),Te.spacing(1),Te.spacing(1),Te.palette.grey[500]),Ae=function(e){var t=e.closeDialog;return r.a.createElement(r.a.Fragment,null,r.a.createElement(Se.a,{variant:"h6"},"Input"),r.a.createElement(Me,{onClick:t},r.a.createElement(Ne.a,null)))},Ce=function(){var e=Object(a.useState)(!1),t=Object(s.a)(e,2),n=t[0],c=t[1];function l(){c(!1)}return r.a.createElement(r.a.Fragment,null,r.a.createElement(f.a,{color:"primary",variant:"contained",onClick:function(){c(!0)}},"Open dialog"),r.a.createElement(m.a,{open:n,scroll:"body",onClose:l},r.a.createElement(d.a,{disableTypography:!0},r.a.createElement(Ae,{closeDialog:l})),r.a.createElement(b.a,{dividers:!0},r.a.createElement(pe,null)),r.a.createElement(p.a,null,r.a.createElement(xe,{closeDialog:l}))))};function Ie(){var e=Object(o.a)(["\n  width: 144px;\n  height: 40px;\n  border: 1px solid black;\n  vertical-align: top;\n  padding: 9px;\n"]);return Ie=function(){return e},e}function ze(){var e=Object(o.a)(["\n  border: 1px solid black;\n  border-collapse: collapse;\n  table-layout: fixed;\n  user-select: none;\n"]);return ze=function(){return e},e}var Be=j.a.table(ze()),Je=j.a.td(Ie()),We=function(e){return Object(g.a)(Array(14)).map((function(t,n){return Object(g.a)(Array(7)).map((function(t,a){return!n&&a?"Th\u1ee9 "+(a+1):n&&!a?"Ti\u1ebft "+n:n||a?"":""+(e+1)}))}))},De=function(e){var t=e.index,n=Object(a.useState)(We(t)),c=Object(s.a)(n,2),l=c[0],u=c[1],i=P().timetables;return Object(a.useEffect)((function(){var e,n=We(t);null===(e=i[t])||void 0===e||e.forEach((function(e){var t=e.subjectId,a=e.subjectName,r=e.group;e.sessions.forEach((function(e){var c=e.day,l=e.start,u=e.length;n[l][c-1]={length:u,subjectId:t,subjectName:a,group:r};for(var i=1;i<u;i++)n[l+i][c-1]=null}))})),u(n)}),[t,i]),r.a.createElement(Be,null,r.a.createElement("tbody",null,l.map((function(e,t){return r.a.createElement("tr",{key:t},e.map((function(e,t){return null!==e&&("object"===typeof e?r.a.createElement(Je,{key:t,rowSpan:e.length},e.subjectId,r.a.createElement("br",null),e.subjectName,r.a.createElement("br",null),"Nh\xf3m "+e.group):r.a.createElement(Je,{key:t},e))})))}))))},Fe=n(79),qe=n.n(Fe),Re=n(80),Ge=n.n(Re);function Ue(){var e=Object(o.a)(["\n  display: flex;\n  justify-content: space-evenly;\n  width: 100%;\n  align-items: center;\n"]);return Ue=function(){return e},e}function Ve(){var e=Object(o.a)(["\n  font-size: 60px;\n"]);return Ve=function(){return e},e}function _e(){var e=Object(o.a)(["\n  font-size: 60px;\n"]);return _e=function(){return e},e}var He=Object(j.a)(qe.a)(_e()),Ke=Object(j.a)(Ge.a)(Ve()),Le=j.a.div(Ue()),Qe=function(){var e=Object(a.useState)(0),t=Object(s.a)(e,2),n=t[0],c=t[1],l=P().timetables;return Object(a.useEffect)((function(){c(0)}),[l]),r.a.createElement(Le,null,r.a.createElement(ke.a,{color:"primary",disabled:!n,onClick:function(){return c(n-1)}},r.a.createElement(He,null)),r.a.createElement(De,{index:n}),r.a.createElement(ke.a,{color:"primary",disabled:!l.length||n===l.length-1,onClick:function(){return c(n+1)}},r.a.createElement(Ke,null)))};function Xe(){var e=Object(o.a)(["\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  height: 100vh;\n  justify-content: space-evenly;\n"]);return Xe=function(){return e},e}var Ye=j.a.div(Xe()),Ze=function(){return r.a.createElement(N,null,r.a.createElement(Ye,null,r.a.createElement(Ce,null),r.a.createElement(Qe,null)))};i.a.render(r.a.createElement(r.a.Fragment,null,r.a.createElement(l.a,null),r.a.createElement(Ze,null)),document.getElementById("root"))},91:function(e,t,n){e.exports=n(117)}},[[91,1,3]]]);
//# sourceMappingURL=main.1f755127.chunk.js.map